<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main-layout}">
<head>
    <title>상품 상세</title>
    <th:block layout:fragment="css">
        <style>
            .product-detail-container {
                min-height: 60vh;
            }
            .product-image {
                border-radius: 1rem;
                overflow: hidden;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            }
            .product-image img {
                width: 100%;
                height: auto;
                object-fit: cover;
                transition: transform 0.5s ease;
            }
            .product-image:hover img {
                transform: scale(1.05);
            }
            .product-thumbnails {
                display: flex;
                gap: 0.5rem;
                margin-top: 1rem;
            }
            .product-thumbnail {
                width: 80px;
                height: 80px;
                border-radius: 0.5rem;
                overflow: hidden;
                cursor: pointer;
                border: 2px solid transparent;
                transition: all 0.3s ease;
            }
            .product-thumbnail.active {
                border-color: var(--primary-color);
            }
            .product-thumbnail img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }
            .product-info {
                padding: 1rem;
            }
            .product-title {
                font-size: 2rem;
                font-weight: 700;
                margin-bottom: 0.5rem;
            }
            .product-price {
                font-size: 1.5rem;
                font-weight: 700;
                color: var(--primary-color);
                margin-bottom: 1rem;
            }
            .product-price .original-price {
                text-decoration: line-through;
                color: var(--gray-500);
                font-size: 1.25rem;
                margin-right: 0.5rem;
            }
            .product-rating {
                color: var(--warning-color);
                margin-bottom: 1rem;
            }
            .product-description {
                margin-bottom: 1.5rem;
                color: var(--gray-700);
            }
            .product-meta {
                margin-bottom: 1.5rem;
            }
            .product-meta-item {
                display: flex;
                margin-bottom: 0.5rem;
            }
            .product-meta-label {
                width: 100px;
                font-weight: 600;
                color: var(--gray-700);
            }
            .product-meta-value {
                color: var(--gray-800);
            }
            .product-actions {
                margin-bottom: 1.5rem;
            }
            .quantity-control {
                display: flex;
                align-items: center;
                max-width: 150px;
                margin-bottom: 1rem;
            }
            .quantity-control .btn {
                width: 40px;
                height: 40px;
                padding: 0;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 0.5rem;
            }
            .quantity-control input {
                width: 60px;
                text-align: center;
                border: 1px solid var(--gray-300);
                border-radius: 0.5rem;
                margin: 0 0.5rem;
                padding: 0.5rem;
            }
            .product-tabs {
                margin-top: 3rem;
            }
            .nav-tabs {
                border-bottom: 2px solid var(--gray-200);
            }
            .nav-tabs .nav-link {
                border: none;
                border-bottom: 2px solid transparent;
                border-radius: 0;
                padding: 1rem 1.5rem;
                font-weight: 600;
                color: var(--gray-600);
                margin-bottom: -2px;
            }
            .nav-tabs .nav-link.active {
                color: var(--primary-color);
                border-bottom-color: var(--primary-color);
            }
            .tab-content {
                padding: 2rem 0;
            }
            .review-item {
                border-bottom: 1px solid var(--gray-200);
                padding-bottom: 1.5rem;
                margin-bottom: 1.5rem;
            }
            .review-item:last-child {
                border-bottom: none;
                padding-bottom: 0;
                margin-bottom: 0;
            }
            .review-header {
                display: flex;
                justify-content: space-between;
                margin-bottom: 0.5rem;
            }
            .review-author {
                font-weight: 600;
            }
            .review-date {
                color: var(--gray-500);
                font-size: 0.9rem;
            }
            .review-rating {
                color: var(--warning-color);
                margin-bottom: 0.5rem;
            }
            .review-content {
                color: var(--gray-700);
            }
            .related-products {
                margin-top: 3rem;
            }
            .related-product-card {
                border-radius: 1rem;
                overflow: hidden;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
                transition: all 0.3s ease;
                border: none;
                margin-bottom: 1.5rem;
            }
            .related-product-card:hover {
                transform: translateY(-10px);
                box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
            }
            .related-product-img {
                height: 200px;
                object-fit: cover;
            }
            .badge-container {
                position: absolute;
                top: 1rem;
                left: 1rem;
                z-index: 10;
            }
            .product-badge {
                display: inline-block;
                padding: 0.25rem 0.75rem;
                border-radius: 50rem;
                font-size: 0.75rem;
                font-weight: 600;
                text-transform: uppercase;
                margin-right: 0.5rem;
            }
            .badge-new {
                background-color: var(--primary-color);
                color: white;
            }
            .badge-sale {
                background-color: var(--accent-color);
                color: white;
            }
            .badge-hot {
                background-color: var(--danger-color);
                color: white;
            }
            .badge-out-of-stock {
                background-color: var(--gray-600);
                color: white;
            }
        </style>
    </th:block>
</head>
<body>
<main layout:fragment="content">
    <section class="py-5">
        <div class="container">
            <!-- 상품 상세 정보 -->
            <div class="product-detail-container">
                <div class="row">
                    <!-- 상품 이미지 -->
                    <div class="col-lg-6 mb-4 mb-lg-0">
                        <div class="product-image">
                            <img th:src="${product != null && product.mainImage != null ? product.mainImage : '/placeholder.svg?height=600&width=600'}"
                                 th:alt="${product != null ? product.name : '프리미엄 데님 자켓'}"
                                 id="mainProductImage">
                        </div>
                        <div class="product-thumbnails">
                            <!-- 썸네일 이미지 (실제로는 DB에서 가져올 것) -->
                            <div th:each="image, stat : ${productImages != null ? productImages : {
                                        '/placeholder.svg?height=80&width=80',
                                        '/placeholder.svg?height=80&width=80&text=Side',
                                        '/placeholder.svg?height=80&width=80&text=Back',
                                        '/placeholder.svg?height=80&width=80&text=Detail'
                                    }}"
                                 class="product-thumbnail" th:classappend="${stat.index == 0 ? 'active' : ''}"
                                 th:data-image="${image}">
                                <img th:src="${image}" th:alt="${'상품 이미지 ' + (stat.index + 1)}">
                            </div>
                        </div>
                    </div>

                    <!-- 상품 정보 -->
                    <div class="col-lg-6">
                        <div class="product-info">
                            <div class="badge-container">
                                <span th:if="${product != null && product.isNew}" class="product-badge badge-new">NEW</span>
                                <span th:if="${product != null && product.discountRate > 0}" class="product-badge badge-sale"
                                      th:text="${product.discountRate + '% OFF'}">20% OFF</span>
                                <span th:if="${product != null && product.isHot}" class="product-badge badge-hot">HOT</span>
                                <span th:if="${product != null && !product.inStock}" class="product-badge badge-out-of-stock">품절</span>
                            </div>

                            <h1 class="product-title" th:text="${product != null ? product.name : '프리미엄 데님 자켓'}">프리미엄 데님 자켓</h1>

                            <div class="product-rating">
                                <!-- 별점 표시 (실제로는 계산해서 표시) -->
                                <th:block th:with="rating=${product != null ? product.rating : 4.5}, fullStars=${#numbers.formatDecimal(rating, 0, 0)}, hasHalfStar=${rating % 1 >= 0.5}">
                                    <i th:each="i : ${#numbers.sequence(1, fullStars)}" class="fas fa-star"></i>
                                    <i th:if="${hasHalfStar}" class="fas fa-star-half-alt"></i>
                                    <i th:each="i : ${#numbers.sequence(1, 5 - fullStars - (hasHalfStar ? 1 : 0))}" class="far fa-star"></i>
                                    <span class="ms-2 text-muted" th:text="${'(' + rating + ') ' + (product != null ? product.reviewCount : 24) + '개 리뷰'}"></span>
                                </th:block>
                            </div>

                            <div class="product-price">
                                    <span th:if="${product != null && product.originalPrice > product.price}" class="original-price"
                                          th:text="${'₩' + #numbers.formatInteger(product.originalPrice, 0, 'COMMA')}">₩65,000</span>
                                <span th:text="${'₩' + #numbers.formatInteger(product != null ? product.price : 52000, 0, 'COMMA')}">₩52,000</span>
                            </div>

                            <div class="product-description" th:text="${product != null ? product.description : '최고급 데님 소재로 제작된 프리미엄 자켓입니다. 편안한 착용감과 세련된 디자인으로 다양한 스타일링이 가능합니다. 내구성이 뛰어나 오랫동안 착용할 수 있습니다.'}">
                                최고급 데님 소재로 제작된 프리미엄 자켓입니다. 편안한 착용감과 세련된 디자인으로 다양한 스타일링이 가능합니다. 내구성이 뛰어나 오랫동안 착용할 수 있습니다.
                            </div>

                            <div class="product-meta">
                                <div class="product-meta-item">
                                    <div class="product-meta-label">상품 코드</div>
                                    <div class="product-meta-value" th:text="${product != null ? product.code : 'DJ-1001'}">DJ-1001</div>
                                </div>
                                <div class="product-meta-item">
                                    <div class="product-meta-label">카테고리</div>
                                    <div class="product-meta-value" th:text="${product != null ? product.category : '의류 > 자켓/코트'}">의류 > 자켓/코트</div>
                                </div>
                                <div class="product-meta-item">
                                    <div class="product-meta-label">브랜드</div>
                                    <div class="product-meta-value" th:text="${product != null ? product.brand : 'PeakMe'}">PeakMe</div>
                                </div>
                                <div class="product-meta-item">
                                    <div class="product-meta-label">재고 상태</div>
                                    <div class="product-meta-value" th:text="${product != null && product.inStock ? '재고 있음' : '품절'}">재고 있음</div>
                                </div>
                            </div>

                            <div class="product-actions" th:if="${product == null || product.inStock}">
                                <div class="mb-3">
                                    <label for="size" class="form-label">사이즈</label>
                                    <select class="form-select" id="size" name="size">
                                        <option value="">사이즈 선택</option>
                                        <option th:each="size : ${sizes != null ? sizes : {'S', 'M', 'L', 'XL'}}"
                                                th:value="${size}"
                                                th:text="${size}"></option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="color" class="form-label">색상</label>
                                    <select class="form-select" id="color" name="color">
                                        <option value="">색상 선택</option>
                                        <option th:each="color : ${colors != null ? colors : {'블루', '블랙', '그레이'}}"
                                                th:value="${color}"
                                                th:text="${color}"></option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="quantity" class="form-label">수량</label>
                                    <div class="quantity-control">
                                        <button class="btn btn-outline-secondary" id="decreaseQuantity">
                                            <i class="fas fa-minus"></i>
                                        </button>
                                        <input type="number" class="form-control" id="quantity" name="quantity" value="1" min="1" max="10">
                                        <button class="btn btn-outline-secondary" id="increaseQuantity">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>

                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" id="addToCart">
                                        <i class="fas fa-shopping-cart me-2"></i> 장바구니에 담기
                                    </button>
                                    <button class="btn btn-outline-primary" id="addToWishlist">
                                        <i class="fas fa-heart me-2"></i> 위시리스트에 추가
                                    </button>
                                </div>
                            </div>

                            <div class="product-actions" th:if="${product != null && !product.inStock}">
                                <div class="alert alert-warning">
                                    <i class="fas fa-exclamation-circle me-2"></i> 현재 품절된 상품입니다. 재입고 알림을 신청하시면 재입고 시 알려드립니다.
                                </div>
                                <div class="d-grid">
                                    <button class="btn btn-outline-primary" id="restockNotification">
                                        <i class="fas fa-bell me-2"></i> 재입고 알림 신청
                                    </button>
                                </div>
                            </div>

                            <div class="mt-4">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-truck text-primary me-2"></i>
                                    <span>무료 배송 (3만원 이상 구매 시)</span>
                                </div>
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-undo text-primary me-2"></i>
                                    <span>30일 이내 무료 반품</span>
                                </div>
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-shield-alt text-primary me-2"></i>
                                    <span>안전한 결제</span>
                                </div>
                            </div>

                            <div class="mt-4">
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-outline-secondary" onclick="shareProduct('facebook')">
                                        <i class="fab fa-facebook-f"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="shareProduct('twitter')">
                                        <i class="fab fa-twitter"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="shareProduct('pinterest')">
                                        <i class="fab fa-pinterest-p"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="shareProduct('kakao')">
                                        <i class="fas fa-comment"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 상품 탭 -->
                <div class="product-tabs">
                    <ul class="nav nav-tabs" id="productTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="description-tab" data-bs-toggle="tab" data-bs-target="#description" type="button" role="tab" aria-controls="description" aria-selected="true">상세 정보</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="specifications-tab" data-bs-toggle="tab" data-bs-target="#specifications" type="button" role="tab" aria-controls="specifications" aria-selected="false">제품 사양</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab" aria-controls="reviews" aria-selected="false">리뷰 <span class="badge bg-primary" th:text="${product != null ? product.reviewCount : 24}">24</span></button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="shipping-tab" data-bs-toggle="tab" data-bs-target="#shipping" type="button" role="tab" aria-controls="shipping" aria-selected="false">배송 및 반품</button>
                        </li>
                    </ul>
                    <div class="tab-content" id="productTabsContent">
                        <!-- 상세 정보 탭 -->
                        <div class="tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="description-tab">
                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    <h4>제품 설명</h4>
                                    <p th:text="${product != null ? product.detailDescription : '최고급 데님 소재로 제작된 프리미엄 자켓입니다. 편안한 착용감과 세련된 디자인으로 다양한 스타일링이 가능합니다. 내구성이 뛰어나 오랫동안 착용할 수 있습니다.'}">
                                        최고급 데님 소재로 제작된 프리미엄 자켓입니다. 편안한 착용감과 세련된 디자인으로 다양한 스타일링이 가능합니다. 내구성이 뛰어나 오랫동안 착용할 수 있습니다.
                                    </p>
                                    <p>
                                        특수 가공된 데님 원단을 사용하여 일반 데님보다 부드러운 착용감을 제공합니다. 또한 신축성이 뛰어나 활동성이 좋으며, 세탁 후에도 변형이 적습니다.
                                    </p>
                                    <p>
                                        클래식한 디자인에 현대적인 감각을 더해 어떤 스타일에도 잘 어울립니다. 캐주얼한 티셔츠와 함께 입거나 셔츠와 함께 세미 캐주얼 룩으로 연출할 수 있습니다.
                                    </p>
                                </div>
                                <div class="col-md-6 mb-4">
                                    <h4>주요 특징</h4>
                                    <ul>
                                        <li>고품질 데님 소재 사용</li>
                                        <li>편안한 착용감과 우수한 내구성</li>
                                        <li>세련된 디자인으로 다양한 스타일링 가능</li>
                                        <li>깔끔한 실루엣과 완벽한 피팅</li>
                                        <li>고급스러운 버튼과 디테일</li>
                                        <li>다양한 사이즈와 색상 옵션</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <h4>착용 및 관리 방법</h4>
                                    <p>
                                        이 제품은 30도 이하의 물에서 중성세제로 손세탁하거나 드라이클리닝을 권장합니다. 세탁기 사용 시에는 뒤집어서 세탁망에 넣어 세탁해주세요. 건조기 사용은 피하고 그늘에서 자연 건조하세요.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- 제품 사양 탭 -->
                        <div class="tab-pane fade" id="specifications" role="tabpanel" aria-labelledby="specifications-tab">
                            <h4>제품 사양</h4>
                            <div class="table-responsive">
                                <table class="table table-bordered">
                                    <tbody>
                                    <tr>
                                        <th style="width: 30%">소재</th>
                                        <td>면 98%, 폴리우레탄 2%</td>
                                    </tr>
                                    <tr>
                                        <th>제조국</th>
                                        <td>대한민국</td>
                                    </tr>
                                    <tr>
                                        <th>제조사</th>
                                        <td>PeakMe Fashion</td>
                                    </tr>
                                    <tr>
                                        <th>세탁 방법</th>
                                        <td>30도 이하 물에서 중성세제로 손세탁 또는 드라이클리닝</td>
                                    </tr>
                                    <tr>
                                        <th>사이즈 정보</th>
                                        <td>S: 어깨 45cm, 가슴 52cm, 소매 62cm, 총장 68cm<br>
                                            M: 어깨 47cm, 가슴 54cm, 소매 63cm, 총장 70cm<br>
                                            L: 어깨 49cm, 가슴 56cm, 소매 64cm, 총장 72cm<br>
                                            XL: 어깨 51cm, 가슴 58cm, 소매 65cm, 총장 74cm</td>
                                    </tr>
                                    <tr>
                                        <th>색상</th>
                                        <td>블루, 블랙, 그레이</td>
                                    </tr>
                                    <tr>
                                        <th>중량</th>
                                        <td>약 650g (M 사이즈 기준)</td>
                                    </tr>
                                    <tr>
                                        <th>제품 특징</th>
                                        <td>신축성 있는 데님 소재, 버튼 여밈, 가슴 포켓 2개, 허리 포켓 2개</td>
                                    </tr>
                                    <tr>
                                        <th>품질보증기준</th>
                                        <td>관련 법 및 소비자 분쟁해결 규정에 따름</td>
                                    </tr>
                                    <tr>
                                        <th>A/S 정보</th>
                                        <td>고객센터 (02-123-4567)</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- 리뷰 탭 -->
                        <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h4>고객 리뷰</h4>
                                <button class="btn btn-primary" id="writeReview">
                                    <i class="fas fa-pen me-2"></i> 리뷰 작성
                                </button>
                            </div>

                            <div class="row mb-4">
                                <div class="col-md-4">
                                    <div class="text-center">
                                        <h2 class="display-4 fw-bold text-primary" th:text="${product != null ? product.rating : 4.5}">4.5</h2>
                                        <div class="product-rating mb-2">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star-half-alt"></i>
                                        </div>
                                        <p class="text-muted" th:text="${'총 ' + (product != null ? product.reviewCount : 24) + '개 리뷰 기준'}">총 24개 리뷰 기준</p>
                                    </div>
                                </div>
                                <div class="col-md-8">
                                    <div class="mb-2">
                                        <div class="d-flex align-items-center">
                                            <div style="width: 60px">5점</div>
                                            <div class="progress flex-grow-1" style="height: 10px">
                                                <div class="progress-bar bg-primary" role="progressbar" style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <div class="ms-2">70%</div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <div class="d-flex align-items-center">
                                            <div style="width: 60px">4점</div>
                                            <div class="progress flex-grow-1" style="height: 10px">
                                                <div class="progress-bar bg-primary" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <div class="ms-2">20%</div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <div class="d-flex align-items-center">
                                            <div style="width: 60px">3점</div>
                                            <div class="progress flex-grow-1" style="height: 10px">
                                                <div class="progress-bar bg-primary" role="progressbar" style="width: 5%" aria-valuenow="5" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <div class="ms-2">5%</div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <div class="d-flex align-items-center">
                                            <div style="width: 60px">2점</div>
                                            <div class="progress flex-grow-1" style="height: 10px">
                                                <div class="progress-bar bg-primary" role="progressbar" style="width: 3%" aria-valuenow="3" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <div class="ms-2">3%</div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <div class="d-flex align-items-center">
                                            <div style="width: 60px">1점</div>
                                            <div class="progress flex-grow-1" style="height: 10px">
                                                <div class="progress-bar bg-primary" role="progressbar" style="width: 2%" aria-valuenow="2" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <div class="ms-2">2%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 리뷰 목록 (실제로는 DB에서 가져올 것) -->
                            <div class="reviews-list">
                                <div th:each="review, stat : ${reviews != null ? reviews : {
                                            {1, '홍길동', 5, '2023-06-15', '정말 만족스러운 구매였습니다. 소재도 좋고 핏도 완벽해요. 배송도 빨랐고 포장도 꼼꼼하게 잘 되어 있었습니다. 다른 색상으로도 구매할 예정입니다.'},
                                            {2, '김철수', 4, '2023-06-10', '전체적으로 만족합니다. 사이즈는 정사이즈에요. 다만 생각보다 두께가 얇은 편이라 초가을까지만 입을 수 있을 것 같아요.'},
                                            {3, '이영희', 5, '2023-06-05', '오래 기다린 제품인데 기대 이상이에요! 핏이 정말 예쁘고 데님 소재가 부드러워서 착용감이 좋습니다.'},
                                            {4, '박민수', 3, '2023-05-28', '품질은 좋은데 사이즈가 생각보다 작게 나와서 교환했어요. 교환 과정은 수월했습니다.'}
                                        }}"
                                     class="review-item">
                                    <div class="review-header">
                                        <div class="review-author" th:text="${review[1]}">홍길동</div>
                                        <div class="review-date" th:text="${review[3]}">2023-06-15</div>
                                    </div>
                                    <div class="review-rating">
                                        <i th:each="i : ${#numbers.sequence(1, review[2])}" class="fas fa-star"></i>
                                        <i th:each="i : ${#numbers.sequence(1, 5 - review[2])}" class="far fa-star"></i>
                                    </div>
                                    <div class="review-content" th:text="${review[4]}">
                                        정말 만족스러운 구매였습니다. 소재도 좋고 핏도 완벽해요. 배송도 빨랐고 포장도 꼼꼼하게 잘 되어 있었습니다. 다른 색상으로도 구매할 예정입니다.
                                    </div>
                                </div>
                            </div>

                            <!-- 페이지네이션 -->
                            <nav aria-label="Page navigation" class="mt-4">
                                <ul class="pagination justify-content-center">
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#" tabindex="-1" aria-disabled="true">이전</a>
                                    </li>
                                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                                    <li class="page-item">
                                        <a class="page-link" href="#">다음</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>

                        <!-- 배송 및 반품 탭 -->
                        <div class="tab-pane fade" id="shipping" role="tabpanel" aria-labelledby="shipping-tab">
                            <h4>배송 정보</h4>
                            <div class="table-responsive mb-4">
                                <table class="table table-bordered">
                                    <tbody>
                                    <tr>
                                        <th style="width: 30%">배송 방법</th>
                                        <td>택배</td>
                                    </tr>
                                    <tr>
                                        <th>배송 지역</th>
                                        <td>전국</td>
                                    </tr>
                                    <tr>
                                        <th>배송 비용</th>
                                        <td>3,000원 (3만원 이상 구매 시 무료배송)</td>
                                    </tr>
                                    <tr>
                                        <th>배송 기간</th>
                                        <td>결제 확인 후 1~3일 이내 발송 (주말, 공휴일 제외)</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>

                            <h4>교환 및 반품 정보</h4>
                            <div class="table-responsive">
                                <table class="table table-bordered">
                                    <tbody>
                                    <tr>
                                        <th style="width: 30%">교환/반품 기간</th>
                                        <td>상품 수령 후 7일 이내 (단, 상품 불량 및 오배송의 경우 30일 이내)</td>
                                    </tr>
                                    <tr>
                                        <th>교환/반품 비용</th>
                                        <td>고객 변심으로 인한 교환/반품 시 왕복 배송비 6,000원 부담<br>
                                            상품 불량 및 오배송의 경우 무료</td>
                                    </tr>
                                    <tr>
                                        <th>교환/반품 불가 사유</th>
                                        <td>
                                            - 고객님의 책임 있는 사유로 상품이 훼손된 경우<br>
                                            - 상품 수령 후 7일이 경과한 경우<br>
                                            - 상품 택이 제거되었거나 포장이 훼손된 경우<br>
                                            - 착용 흔적이 있거나 세탁한 경우<br>
                                            - 고객님의 요청에 의해 주문 제작된 상품인 경우
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>교환/반품 절차</th>
                                        <td>
                                            1. 마이페이지 > 주문내역에서 교환/반품 신청<br>
                                            2. 고객센터(02-123-4567)로 연락하여 교환/반품 접수<br>
                                            3. 안내에 따라 상품 발송<br>
                                            4. 상품 확인 후 교환/환불 처리
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 관련 상품 -->
                <div class="related-products">
                    <h3 class="mb-4">관련 상품</h3>
                    <div class="row">
                        <!-- 관련 상품 목록 (실제로는 DB에서 가져올 것) -->
                        <div th:each="product, stat : ${relatedProducts != null ? relatedProducts : {
                                    {1, '캐주얼 티셔츠', 35000, 35000, 4.0, '/placeholder.svg?height=200&width=200'},
                                    {2, '슬림핏 청바지', 75000, 60000, 5.0, '/placeholder.svg?height=200&width=200'},
                                    {3, '클래식 레더 자켓', 120000, 120000, 5.0, '/placeholder.svg?height=200&width=200'},
                                    {4, '캐주얼 후드티', 55000, 55000, 4.0, '/placeholder.svg?height=200&width=200'}
                                }}"
                             class="col-6 col-md-3">
                            <div class="card related-product-card">
                                <img th:src="${product[5]}" class="card-img-top related-product-img" th:alt="${product[1]}">
                                <div class="card-body">
                                    <h5 class="card-title" th:text="${product[1]}">상품명</h5>
                                    <div class="product-rating">
                                        <i th:each="i : ${#numbers.sequence(1, #numbers.formatDecimal(product[4], 0, 0))}" class="fas fa-star"></i>
                                        <i th:if="${product[4] % 1 >= 0.5}" class="fas fa-star-half-alt"></i>
                                        <i th:each="i : ${#numbers.sequence(1, 5 - #numbers.formatDecimal(product[4], 0, 0) - (product[4] % 1 >= 0.5 ? 1 : 0))}" class="far fa-star"></i>
                                    </div>
                                    <div class="product-price">
                                        <span th:if="${product[2] > product[3]}" class="original-price" th:text="${'₩' + #numbers.formatInteger(product[2], 0, 'COMMA')}">원가</span>
                                        <span th:text="${'₩' + #numbers.formatInteger(product[3], 0, 'COMMA')}">판매가</span>
                                    </div>
                                    <div class="d-grid gap-2 mt-2">
                                        <a th:href="@{'/products/' + ${product[0]}}" class="btn btn-sm btn-outline-primary">상세 보기</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 리뷰 작성 모달 -->
    <div class="modal fade" id="reviewModal" tabindex="-1" aria-labelledby="reviewModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reviewModalLabel">리뷰 작성</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form th:action="@{'/products/' + ${product != null ? product.id : '1'} + '/review'}" method="post">
                        <div class="mb-3">
                            <label for="reviewRating" class="form-label">평점</label>
                            <div class="rating-stars">
                                <div class="d-flex">
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="rating" id="rating1" value="1">
                                        <label class="form-check-label" for="rating1"><i class="fas fa-star"></i></label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="rating" id="rating2" value="2">
                                        <label class="form-check-label" for="rating2"><i class="fas fa-star"></i></label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="rating" id="rating3" value="3">
                                        <label class="form-check-label" for="rating3"><i class="fas fa-star"></i></label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="rating" id="rating4" value="4">
                                        <label class="form-check-label" for="rating4"><i class="fas fa-star"></i></label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="rating" id="rating5" value="5" checked>
                                        <label class="form-check-label" for="rating5"><i class="fas fa-star"></i></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="reviewTitle" class="form-label">제목</label>
                            <input type="text" class="form-control" id="reviewTitle" name="title" placeholder="리뷰 제목을 입력하세요" required>
                        </div>
                        <div class="mb-3">
                            <label for="reviewContent" class="form-label">내용</label>
                            <textarea class="form-control" id="reviewContent" name="content" rows="5" placeholder="리뷰 내용을 입력하세요" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="reviewImage" class="form-label">이미지 첨부 (선택)</label>
                            <input type="file" class="form-control" id="reviewImage" name="image">
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">리뷰 등록</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 재입고 알림 모달 -->
    <div class="modal fade" id="restockModal" tabindex="-1" aria-labelledby="restockModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="restockModalLabel">재입고 알림 신청</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form th:action="@{'/products/' + ${product != null ? product.id : '1'} + '/restock-notification'}" method="post">
                        <div class="mb-3">
                            <label for="restockEmail" class="form-label">이메일</label>
                            <input type="email" class="form-control" id="restockEmail" name="email" placeholder="이메일을 입력하세요" required>
                        </div>
                        <div class="mb-3">
                            <label for="restockPhone" class="form-label">휴대폰 번호 (선택)</label>
                            <input type="tel" class="form-control" id="restockPhone" name="phone" placeholder="휴대폰 번호를 입력하세요">
                        </div>
                        <div class="mb-3">
                            <label for="restockSize" class="form-label">사이즈</label>
                            <select class="form-select" id="restockSize" name="size" required>
                                <option value="">사이즈 선택</option>
                                <option th:each="size : ${sizes != null ? sizes : {'S', 'M', 'L', 'XL'}}"
                                        th:value="${size}"
                                        th:text="${size}"></option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="restockColor" class="form-label">색상</label>
                            <select class="form-select" id="restockColor" name="color" required>
                                <option value="">색상 선택</option>
                                <option th:each="color : ${colors != null ? colors : {'블루', '블랙', '그레이'}}"
                                        th:value="${color}"
                                        th:text="${color}"></option>
                            </select>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">알림 신청</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</main>

<th:block layout:fragment="script">
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 썸네일 이미지 클릭 이벤트
            const thumbnails = document.querySelectorAll('.product-thumbnail');
            const mainImage = document.getElementById('mainProductImage');

            thumbnails.forEach(thumbnail => {
                thumbnail.addEventListener('click', function() {
                    // 활성화된 썸네일 클래스 제거
                    thumbnails.forEach(t => t.classList.remove('active'));

                    // 클릭한 썸네일 활성화
                    this.classList.add('active');

                    // 메인 이미지 변경
                    const imageUrl = this.getAttribute('data-image');
                    mainImage.src = imageUrl;
                });
            });

            // 수량 증가/감소 버튼 이벤트
            const decreaseBtn = document.getElementById('decreaseQuantity');
            const increaseBtn = document.getElementById('increaseQuantity');
            const quantityInput = document.getElementById('quantity');

            decreaseBtn.addEventListener('click', function() {
                let quantity = parseInt(quantityInput.value);
                if (quantity > 1) {
                    quantityInput.value = quantity - 1;
                }
            });

            increaseBtn.addEventListener('click', function() {
                let quantity = parseInt(quantityInput.value);
                if (quantity < 10) {
                    quantityInput.value = quantity + 1;
                }
            });

            // 장바구니 담기 버튼 이벤트
            const addToCartBtn = document.getElementById('addToCart');
            if (addToCartBtn) {
                addToCartBtn.addEventListener('click', function() {
                    const size = document.getElementById('size').value;
                    const color = document.getElementById('color').value;
                    const quantity = document.getElementById('quantity').value;

                    if (!size) {
                        alert('사이즈를 선택해주세요.');
                        return;
                    }

                    if (!color) {
                        alert('색상을 선택해주세요.');
                        return;
                    }

                    // 장바구니에 상품 추가 (실제로는 서버에 요청)
                    console.log(`장바구니에 추가: 상품ID=${product != null ? product.id : 1}, 사이즈=${size}, 색상=${color}, 수량=${quantity}`);

                    // 임시 알림
                    alert('상품이 장바구니에 추가되었습니다.');
                });
            }

            // 위시리스트 추가 버튼 이벤트
            const addToWishlistBtn = document.getElementById('addToWishlist');
            if (addToWishlistBtn) {
                addToWishlistBtn.addEventListener('click', function() {
                    // 위시리스트에 상품 추가 (실제로는 서버에 요청)
                    console.log(`위시리스트에 추가: 상품ID=${product != null ? product.id : 1}`);

                    // 임시 알림
                    alert('상품이 위시리스트에 추가되었습니다.');
                });
            }

            // 재입고 알림 버튼 이벤트
            const restockNotificationBtn = document.getElementById('restockNotification');
            if (restockNotificationBtn) {
                restockNotificationBtn.addEventListener('click', function() {
                    const restockModal = new bootstrap.Modal(document.getElementById('restockModal'));
                    restockModal.show();
                });
            }

            // 리뷰 작성 버튼 이벤트
            const writeReviewBtn = document.getElementById('writeReview');
            if (writeReviewBtn) {
                writeReviewBtn.addEventListener('click', function() {
                    const reviewModal = new bootstrap.Modal(document.getElementById('reviewModal'));
                    reviewModal.show();
                });
            }
        });

        // 상품 공유 함수
        function shareProduct(platform) {
            const url = window.location.href;
            const title = document.querySelector('.product-title').textContent;

            switch (platform) {
                case 'facebook':
                    window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank');
                    break;
                case 'twitter':
                    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(url)}`, '_blank');
                    break;
                case 'pinterest':
                    window.open(`https://pinterest.com/pin/create/button/?url=${encodeURIComponent(url)}&description=${encodeURIComponent(title)}`, '_blank');
                    break;
                case 'kakao':
                    // 카카오 공유 API 연동 필요
                    alert('카카오 공유 기능은 실제 구현 시 Kakao SDK를 연동해야 합니다.');
                    break;
            }
        }
    </script>
</th:block>
</body>
</html>

