<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main-layout}">
<head>
    <title>쇼핑</title>
</head>
<body>
<main layout:fragment="content">
    <!-- 메인 배너 -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 animate-fade-in">
                    <h1>트렌디한 스타일을<br>발견하세요</h1>
                    <p class="lead">최신 트렌드와 스타일리시한 제품들을 PeakMeShop에서 만나보세요. 당신만의 특별한 스타일을 완성해 드립니다.</p>
                    <div class="d-flex gap-3">
                        <a th:href="@{/products}" class="btn btn-primary">쇼핑하기</a>
                        <a th:href="@{/category/new-arrivals}" class="btn btn-outline-primary">신상품 보기</a>
                    </div>
                </div>
                <div class="col-lg-6 animate-fade-in delay-1">
                    <img th:src="@{/placeholder.svg?height=500&width=600}" alt="쇼핑 배너 이미지" class="img-fluid">
                </div>
            </div>
        </div>
    </section>

    <!-- 카테고리 섹션 -->
    <section class="categories">
        <div class="container">
            <h2>인기 카테고리</h2>
            <div class="row">
                <!-- 카테고리 목록 (실제로는 DB에서 가져올 것) -->
                <div th:each="category, stat : ${categories != null ? categories : {'의류', '신발', '액세서리'}}"
                     class="col-md-4 mb-4 animate-fade-in" th:classappend="${'delay-' + (stat.index + 1)}">
                    <div class="card h-100">
                        <img th:src="@{/placeholder.svg?height=250&width=350}" class="card-img-top" th:alt="${category}">
                        <div class="card-body text-center">
                            <h5 class="card-title" th:text="${category}">카테고리명</h5>
                            <p class="card-text" th:text="${'최신 트렌드의 ' + category + ' 컬렉션을 만나보세요.'}">카테고리 설명</p>
                            <a th:href="@{'/category/' + ${category}}" class="btn btn-primary">둘러보기</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 신상품 섹션 -->
    <section class="new-arrivals">
        <div class="container">
            <h2>신상품</h2>
            <div class="row">
                <!-- 신상품 목록 (실제로는 DB에서 가져올 것) -->
                <div th:each="product, stat : ${newProducts != null ? newProducts : {
                          {1, '프리미엄 데님 자켓', 65000, 52000, 4.5},
                          {2, '캐주얼 티셔츠', 35000, 35000, 4.0},
                          {3, '슬림핏 청바지', 75000, 60000, 5.0},
                          {4, '캐주얼 스니커즈', 85000, 85000, 3.5}
                      }}"
                     class="col-6 col-md-3 mb-4 animate-fade-in" th:classappend="${stat.index > 0 ? 'delay-' + stat.index : ''}">
                    <div class="card h-100">
                        <span class="product-badge badge-new">NEW</span>
                        <img th:src="@{/placeholder.svg?height=300&width=300}" class="card-img-top" th:alt="${product[1]}">
                        <div class="card-body">
                            <h5 class="card-title" th:text="${product[1]}">상품명</h5>
                            <div class="product-rating">
                                <!-- 별점 표시 (완전히 새로운 방식) -->
                                <div class="stars-container">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star" th:if="${product[4] >= 2}"></i>
                                    <i class="fas fa-star" th:if="${product[4] >= 3}"></i>
                                    <i class="fas fa-star" th:if="${product[4] >= 4}"></i>
                                    <i class="fas fa-star" th:if="${product[4] >= 5}"></i>
                                    <i class="fas fa-star-half-alt" th:if="${product[4] % 1 >= 0.5 && product[4] < 5}"></i>
                                    <i class="far fa-star" th:if="${product[4] < 2}"></i>
                                    <i class="far fa-star" th:if="${product[4] < 3}"></i>
                                    <i class="far fa-star" th:if="${product[4] < 4}"></i>
                                    <i class="far fa-star" th:if="${product[4] < 5 && product[4] % 1 < 0.5}"></i>
                                    <span class="ms-2 text-muted" th:text="${'(' + product[4] + ')'}"></span>
                                </div>
                            </div>
                            <div class="product-price">
                                <span th:if="${product[2] > product[3]}" class="original-price" th:text="${'₩' + #numbers.formatInteger(product[2], 0, 'COMMA')}">원가</span>
                                <span th:text="${'₩' + #numbers.formatInteger(product[3], 0, 'COMMA')}">판매가</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <a th:href="@{'/products/' + ${product[0]}}" class="btn btn-sm btn-outline-primary">상세 보기</a>
                                <button class="btn btn-sm btn-primary" th:onclick="'addToCart(' + ${product[0]} + ')'">
                                    <i class="fas fa-shopping-cart me-1"></i> 담기
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <a th:href="@{/category/new-arrivals}" class="btn btn-lg btn-primary">모든 신상품 보기</a>
            </div>
        </div>
    </section>

    <!-- 베스트셀러 섹션 -->
    <section class="best-sellers">
        <div class="container">
            <h2>베스트셀러</h2>
            <div class="row">
                <!-- 베스트셀러 목록 (실제로는 DB에서 가져올 것) -->
                <div th:each="product, stat : ${bestProducts != null ? bestProducts : {
                          {5, '클래식 레더 자켓', 120000, 120000, 5.0},
                          {6, '프리미엄 백팩', 95000, 76000, 4.5},
                          {7, '캐주얼 후드티', 55000, 55000, 4.0},
                          {8, '스포츠 런닝화', 110000, 88000, 5.0}
                      }}"
                     class="col-6 col-md-3 mb-4 animate-fade-in" th:classappend="${stat.index > 0 ? 'delay-' + stat.index : ''}">
                    <div class="card h-100">
                        <span class="product-badge badge-hot">HOT</span>
                        <img th:src="@{/placeholder.svg?height=300&width=300}" class="card-img-top" th:alt="${product[1]}">
                        <div class="card-body">
                            <h5 class="card-title" th:text="${product[1]}">상품명</h5>
                            <div class="product-rating">
                                <!-- 별점 표시 (완전히 새로운 방식) -->
                                <div class="stars-container">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star" th:if="${product[4] >= 2}"></i>
                                    <i class="fas fa-star" th:if="${product[4] >= 3}"></i>
                                    <i class="fas fa-star" th:if="${product[4] >= 4}"></i>
                                    <i class="fas fa-star" th:if="${product[4] >= 5}"></i>
                                    <i class="fas fa-star-half-alt" th:if="${product[4] % 1 >= 0.5 && product[4] < 5}"></i>
                                    <i class="far fa-star" th:if="${product[4] < 2}"></i>
                                    <i class="far fa-star" th:if="${product[4] < 3}"></i>
                                    <i class="far fa-star" th:if="${product[4] < 4}"></i>
                                    <i class="far fa-star" th:if="${product[4] < 5 && product[4] % 1 < 0.5}"></i>
                                    <span class="ms-2 text-muted" th:text="${'(' + product[4] + ')'}"></span>
                                </div>
                            </div>
                            <div class="product-price">
                                <span th:if="${product[2] > product[3]}" class="original-price" th:text="${'₩' + #numbers.formatInteger(product[2], 0, 'COMMA')}">원가</span>
                                <span th:text="${'₩' + #numbers.formatInteger(product[3], 0, 'COMMA')}">판매가</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <a th:href="@{'/products/' + ${product[0]}}" class="btn btn-sm btn-outline-primary">상세 보기</a>
                                <button class="btn btn-sm btn-primary" th:onclick="'addToCart(' + ${product[0]} + ')'">
                                    <i class="fas fa-shopping-cart me-1"></i> 담기
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <a th:href="@{/category/best-sellers}" class="btn btn-lg btn-primary">모든 베스트셀러 보기</a>
            </div>
        </div>
    </section>

    <!-- 특별 할인 섹션 -->
    <section class="special-offers bg-light">
        <div class="container">
            <h2>특별 할인</h2>
            <div class="row align-items-center">
                <div class="col-lg-6 animate-fade-in">
                    <div class="p-4 rounded-4 bg-white shadow">
                        <h3 class="mb-3">시즌 특가 세일</h3>
                        <p class="lead mb-4">최대 50% 할인된 가격으로 프리미엄 제품을 만나보세요. 한정 수량으로 조기 품절될 수 있습니다.</p>
                        <div class="d-flex gap-3">
                            <a th:href="@{/category/sale}" class="btn btn-accent">할인 상품 보기</a>
                            <a th:href="@{/products}" class="btn btn-outline-secondary">모든 상품 보기</a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 mt-4 mt-lg-0 animate-fade-in delay-1">
                    <img th:src="@{/placeholder.svg?height=400&width=600}" alt="특별 할인" class="img-fluid rounded-4 shadow">
                </div>
            </div>
        </div>
    </section>

    <!-- 브랜드 섹션 -->
    <section class="brands">
        <div class="container">
            <h2>인기 브랜드</h2>
            <div class="row justify-content-center">
                <!-- 브랜드 목록 (실제로는 DB에서 가져올 것) -->
                <div th:each="brand, stat : ${brands != null ? brands : {'브랜드1', '브랜드2', '브랜드3', '브랜드4', '브랜드5', '브랜드6'}}"
                     class="col-4 col-md-2 mb-4 text-center animate-fade-in" th:classappend="${stat.index > 0 ? 'delay-' + (stat.index % 4 + 1) : ''}">
                    <img th:src="@{/placeholder.svg?height=80&width=120}" th:alt="${brand}" class="img-fluid">
                </div>
            </div>
        </div>
    </section>

    <!-- 페이지네이션 섹션 (상품 목록이 있을 경우) -->
    <div th:if="${products != null && products.totalPages > 0}" class="container mb-5">
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
                <!-- 이전 페이지 -->
                <li class="page-item" th:classappend="${products != null && products.number != null && products.number > 0 ? '' : 'disabled'}">
                    <a class="page-link" th:href="@{/shop(page=${products != null && products.number != null ? products.number - 1 : 0}, size=${products != null && products.size != null ? products.size : 12}, sort=${param.sort})}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>

                <!-- 페이지 번호 -->
                <th:block th:with="start=${T(Math).max(1, products != null && products.number != null ? products.number - 2 : 0)},
                                    end=${T(Math).min(products != null && products.totalPages != null ? products.totalPages : 1, products != null && products.number != null ? products.number + 3 : 5)}">
                    <li class="page-item" th:each="i : ${#numbers.sequence(start, end)}"
                        th:classappend="${products != null && products.number != null && i == products.number + 1 ? 'active' : ''}">
                        <a class="page-link" th:href="@{/shop(page=${i - 1}, size=${products != null && products.size != null ? products.size : 12}, sort=${param.sort})}" th:text="${i}">1</a>
                    </li>
                </th:block>

                <!-- 다음 페이지 -->
                <li class="page-item" th:classappend="${products != null && products.number != null && products.totalPages != null && products.number < products.totalPages - 1 ? '' : 'disabled'}">
                    <a class="page-link" th:href="@{/shop(page=${products != null && products.number != null ? products.number + 1 : 0}, size=${products != null && products.size != null ? products.size : 12}, sort=${param.sort})}" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>

    <!-- 뉴스레터 섹션 -->
    <section class="newsletter bg-primary text-white py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 text-center">
                    <h3 class="mb-4">뉴스레터 구독하기</h3>
                    <p class="mb-4">최신 트렌드와 특별 할인 정보를 가장 먼저 받아보세요!</p>
                    <form class="row g-3 justify-content-center" th:action="@{/newsletter/subscribe}" method="post">
                        <div class="col-md-8">
                            <input type="email" class="form-control form-control-lg" name="email" placeholder="이메일 주소를 입력하세요" required>
                        </div>
                        <div class="col-md-auto">
                            <button type="submit" class="btn btn-lg btn-light">구독하기</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
</main>
</body>
</html>

